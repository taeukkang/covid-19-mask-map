(this["webpackJsonpcovid-19-mask-map"]=this["webpackJsonpcovid-19-mask-map"]||[]).push([[0],{108:function(e,a,t){},128:function(e,a,t){},130:function(e,a,t){},131:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(28),l=t.n(c),o=t(82),s=t(29),i=t(25),m=t(142),u=t(143),d=t(140),b=t(8),f=t(76),p=t.n(f);t(108);var v=function(){var e=Object(b.b)(),a=e.t,t=e.i18n;return r.a.createElement(m.a,{bg:"light",expand:"lg",className:"mb-3 navbar-mobile-thin"},r.a.createElement(m.a.Brand,{href:"/",className:"title"},r.a.createElement("img",{src:p.a,width:"24px",alt:"\uacf5\uc801 \ub9c8\uc2a4\ud06c \uc9c0\ub3c4 \ub85c\uace0",className:"mr-2"}),a("appName")),r.a.createElement(m.a.Toggle,{"aria-controls":"basic-navbar-nav"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null)),r.a.createElement(m.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(u.a,{className:"ml-auto"},r.a.createElement(d.a,{title:"\ud83c\udf10 Language"},r.a.createElement(d.a.Item,{onClick:function(){return t.changeLanguage("ko")}},"\ud55c\uad6d\uc5b4"),r.a.createElement(d.a.Item,{onClick:function(){return t.changeLanguage("en")}},"English"),r.a.createElement(d.a.Item,{onClick:function(){return t.changeLanguage("zh")}},"\u4e2d\u6587")),r.a.createElement(u.a.Link,{href:"https://livecorona.co.kr"},r.a.createElement(i.a,{icon:s.a,size:"lg"})," ",a("covid19Dashboard")),r.a.createElement(u.a.Link,{href:"https://github.com/LiveCoronaDetector/"},r.a.createElement(i.a,{icon:o.a,size:"lg"})," ",a("github")))))},h=t(6),k=Object(n.createContext)({mapObj:null,setMapObj:function(){},maskStores:{},setMaskStores:function(){},centerCoord:null,setCenterCoord:function(){},markerFilter:{plenty:!0,some:!0,few:!0,empty:!1},setMarkerFilter:function(){}});function E(e){var a=e.children,t=Object(n.useState)(null),c=Object(h.a)(t,2),l=c[0],o=c[1],s=Object(n.useState)([]),i=Object(h.a)(s,2),m=i[0],u=i[1],d=Object(n.useState)(null),b=Object(h.a)(d,2),f=b[0],p=b[1],v=Object(n.useState)({plenty:!0,some:!0,few:!0,empty:!1}),E=Object(h.a)(v,2),g=E[0],w=E[1];return r.a.createElement(k.Provider,{value:{mapObj:l,setMapObj:o,maskStores:m,setMaskStores:u,centerCoord:f,setCenterCoord:p,markerFilter:g,setMarkerFilter:w}},a)}function g(){var e=Object(n.useContext)(k);if(void 0===e)throw new Error("useMaskData must be used within a MaskDataContextProvider");return e}var w=t(26),y=t.n(w),O=t(36),j=t(52),S=t.n(j),C=t(133),x=t(134),M=t(85),D=t(141),N=t(81),F=t(135),_=t(83),L=t(84),I=t.n(L);t(128);var B=function(){var e=Object(_.a)(),a=Object(n.useState)(null),t=Object(h.a)(a,2),c=t[0],l=t[1],o=Object(n.useState)(!1),m=Object(h.a)(o,2),u=m[0],d=m[1],f=g().setCenterCoord,p=Object(b.b)().t,v=Object(n.useState)(""),k=Object(h.a)(v,2),E=k[0],w=k[1],j=function(){var e=Object(O.a)(y.a.mark((function e(a){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.a.get("".concat("https://api.livecorona.co.kr","/?address=").concat(a));case 3:return t=e.sent,e.abrupt("return",t);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),console.log("Failed to retrieve geocoding for: "+a);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(a){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){w(localStorage.getItem("lastSearchedAddress"))}),[]),Object(n.useEffect)((function(){if(e){try{navigator.permissions.query({name:"geolocation"}).then((function(e){l(e.state)}))}catch(t){console.error(t),l("unknown")}if(u&&(null!=e.accuracy||null!=e.latitude||null!=e.longitude)){var a={lat:e.latitude,lng:e.longitude};f(a),console.log(a)}}}),[e,u,f]);var L=function(){var e=Object(O.a)(y.a.mark((function e(){var a,t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(E.length<1)){e.next=3;break}return alert("\uc8fc\uc18c\ub97c \uc785\ub825\ud574 \uc8fc\uc138\uc694."),e.abrupt("return");case 3:return localStorage.setItem("lastSearchedAddress",E),e.prev=4,e.next=7,j(E);case 7:a=e.sent,e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(4),console.error(e.t0),alert("\uc8fc\uc18c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574 \uc8fc\uc2ed\uc2dc\uc624."),e.abrupt("return");case 15:if(console.log(a.data),a.data.meta.totalCount){e.next=19;break}return alert("\uc8fc\uc18c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574 \uc8fc\uc2ed\uc2dc\uc624."),e.abrupt("return");case 19:t={lat:a.data.addresses[0].y,lng:a.data.addresses[0].x},f(t);case 21:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.a,null,r.a.createElement(x.a,null,r.a.createElement(M.a,null,r.a.createElement("div",{className:"text-center mb-5"},r.a.createElement("img",{src:I.a,alt:"\uacf5\uc801 \ub9c8\uc2a4\ud06c \ud310\ub9e4\ucc98",width:"100vw",className:"mb-3"}),r.a.createElement("h1",{className:"title"},p("searchMaskStores"))))),r.a.createElement(x.a,{className:"justify-content-center mb-3 text-center"},r.a.createElement(M.a,{sm:12,md:6,lg:5},r.a.createElement(D.a,{onSubmit:function(e){e.preventDefault(),L()}},r.a.createElement(D.a.Group,{controlId:"formBasicEmail"},r.a.createElement(D.a.Label,null,p("addressInputLabel")),r.a.createElement(D.a.Control,{type:"text",placeholder:"",value:E,onChange:function(e){return w(e.target.value)}}),r.a.createElement(D.a.Text,{className:"text-muted"},p("addressInputExample"))),r.a.createElement("div",{className:"d-flex flex-column mb-3"},r.a.createElement(N.a,{variant:"primary",className:"mb-2",onClick:L},r.a.createElement(i.a,{icon:s.d})," ",p("searchByAddress")),r.a.createElement(N.a,{variant:"outline-primary",onClick:function(){"granted"!==c&&alert("\uc704\uce58 \uad8c\ud55c\uc744 \ube0c\ub77c\uc6b0\uc800 \uc124\uc815\uc5d0\uc11c \ud5c8\uc6a9\ud574\uc57c \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4"),d(!0)}},r.a.createElement(i.a,{icon:s.c})," ",p("searchByGeoloc"))),r.a.createElement(F.a,{variant:"info"},p("notice.publicMaskShutdown")))))))},z=t(55),W=t(86),A=t(138),T=t(60),H=t(90),P=t(61),G=t.n(P),J=t(136);var X=function(e){var a,t,n=e.remainingStockStr,c=Object(b.b)().t;switch(n){case"plenty":a="success",t=c("badge.plenty");break;case"some":a="warning",t=c("badge.some");break;case"few":a="danger",t=c("badge.few");break;case"empty":a="light",t=c("badge.empty");break;case"break":a="secondary",t=c("badge.break");break;default:a="light",t="?"}return r.a.createElement(J.a,{variant:a},t)},Z=function(){var e=Object(n.useState)([]),a=Object(h.a)(e,2),t=a[0],c=a[1],l=Object(n.useState)([]),o=Object(h.a)(l,2),s=o[0],i=o[1],m=Object(n.useState)([]),u=Object(h.a)(m,2),d=u[0],f=u[1],p=Object(n.useState)([]),v=Object(h.a)(p,2),k=v[0],E=v[1],w=Object(n.useState)([]),y=Object(h.a)(w,2),O=y[0],j=y[1],S=Object(n.useState)([]),C=Object(h.a)(S,2),x=C[0],M=C[1],D=Object(b.b)().t,N=g().markerFilter,F=Object(n.useCallback)((function(){t.forEach((function(e){e.setMap(null)})),s.forEach((function(e){e.setMap(null)})),k.forEach((function(e){e.setMap(null)})),d.forEach((function(e){e.setMap(null)})),O.forEach((function(e){e.setMap(null)})),x.forEach((function(e){e.setMap(null)})),c([])}),[t,s,k,d,O,x]);return{addMarker:function(e,a){if(window.naver||window.naver.maps){var t=new window.naver.maps.Marker({map:e,position:{lat:a.lat,lng:a.lng}}),n='\n            <div style="font-size: 0.1rem; padding: 15px;">\n                <h5 style="font-size: 13px">'.concat(a.name,"</h5>\n                <p>").concat(a.addr,"<br />\n                \ub0a8\uc740 \uc218\ub7c9: ").concat(G.a.renderToString(r.a.createElement(X,{remainingStockStr:a.remain_stat})),"</p>\n            </div>"),l=new window.naver.maps.InfoWindow({content:n});window.naver.maps.Event.addListener(t,"mouseover",(function(a){l.open(e,t)})),window.naver.maps.Event.addListener(t,"click",(function(a){l.open(e,t)})),c((function(e){return[].concat(Object(H.a)(e),[t])}))}},addColorIndicatorMarkers:Object(n.useCallback)((function(e,a){if(window.naver||window.naver.maps){var t=[],n=[],c=[],l=[],o=[];a.forEach((function(a){var s,i;if(void 0!==a.remain_stat&&null!==a.remain_stat&&"empty"!==a.remain_stat&&"break"!==a.remain_stat){switch(a.remain_stat){case"plenty":s="green_circle.svg",i="100";break;case"some":s="yellow_circle.svg",i="30";break;case"few":s="red_circle.svg",i="2";break;case"empty":s="gray_circle.svg",i="0";break;case"break":s="gray_circle.svg",i="X";break;default:s="gray_circle.svg",i="X"}var m=new window.naver.maps.Marker({map:e,position:{lat:a.lat,lng:a.lng},icon:{content:'<div class="mask-marker"><img src="./'.concat(s,'" height="30" width="30"></img><p class="marker-text">').concat(i,"</p></div>"),anchor:new window.naver.maps.Point(15,0)}}),u='\n            <div style="font-size: 0.85rem; padding: 5px; width: 200px !important;">\n                <h5 style="font-size: 1rem">'.concat(a.name,'</h5>\n                <p className="mb-0 pb-0">').concat(a.addr,"<br />\n                \ub0a8\uc740 \uc218\ub7c9: ").concat(G.a.renderToString(r.a.createElement(X,{remainingStockStr:a.remain_stat})),' | <a href="https://map.naver.com/v5/search/').concat(a.name,'" target="_blank" rel="noopener noreferrer"\n                >').concat(D("showDirections"),"</a> </p>\n            </div>"),d=new window.naver.maps.InfoWindow({content:u});switch(window.naver.maps.Event.addListener(m,"mouseover",(function(a){d.open(e,m)})),window.naver.maps.Event.addListener(m,"click",(function(a){d.open(e,m)})),a.remain_stat){case"plenty":t.push(m);break;case"some":n.push(m);break;case"few":c.push(m);break;case"empty":l.push(m);break;case"break":o.push(m);break;default:l.push(m)}}})),F(),i(t),f(n),E(c),j(c),M(c)}}),[N]),resetMarker:F}},q=function(){return Object(n.useCallback)((function(e,a){if(a={center:{lat:36.377165,lng:127.533382},zoom:1,zoomControl:!0,disableDoubleClickZoom:!0},window.naver&&e.current)return new window.naver.maps.Map(e.current,a)}),[])};var R=function(){var e=g().setMapObj,a=Object(n.useRef)(),t=q();return Object(n.useEffect)((function(){e(t(a))}),[t,e]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"map",ref:a,style:{minHeight:"45vh",height:"45vh",maxHeight:"65vh"}}))},V=t(137);var $=function(){var e=Object(b.b)().t,a=g().maskStores;return r.a.createElement(r.a.Fragment,null,r.a.createElement(V.a,{responsive:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,e("storeData.name")),r.a.createElement("th",null,e("storeData.stockCount")),r.a.createElement("th",null,e("storeData.address")))),r.a.createElement("tbody",null,a.map((function(e){return r.a.createElement("tr",{key:e.code},r.a.createElement("td",null,e.name),r.a.createElement("td",null,r.a.createElement(X,{remainingStockStr:e.remain_stat})),r.a.createElement("td",null,e.addr))})))))};t(130);var K=function(){var e=Object(b.b)(),a=e.t,t=e.i18n,c=g(),l=c.mapObj,o=c.maskStores,m=c.setMaskStores,u=c.centerCoord,d=c.setCenterCoord,f=Z(),p=f.addColorIndicatorMarkers,v=f.resetMarker,k=Object(n.useState)(!1),E=Object(h.a)(k,2),w=E[0],j=E[1],D=Object(n.useState)(!1),_=Object(h.a)(D,2),L=_[0],I=_[1],B=Object(n.useState)(!0),H=Object(h.a)(B,2),P=H[0],G=H[1],J=Object(n.useState)({plenty:!0,some:!0,few:!0,empty:!1}),q=Object(h.a)(J,2),V=q[0],K=q[1],Q=Object(n.useCallback)((function(e){var a=["plenty","some","few","empty","break",null,void 0];e.sort((function(e,t){return a.indexOf(e.remain_stat)-a.indexOf(t.remain_stat)})),m(e)}),[m]),U=function(e){var a=e.target;console.log(a),K((function(e){return Object(W.a)({},e,Object(z.a)({},a.name,a.checked))}))};return Object(n.useEffect)((function(){console.log(V)}),[V]),Object(n.useEffect)((function(){var e=function(){var e=Object(O.a)(y.a.mark((function e(a,t){var n,r;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://8oi9s0nnth.apigw.ntruss.com/corona19-masks/v1/storesByGeo/json?lat=".concat(a.lat,"&lng=").concat(a.lng,"&m=").concat(t),e.prev=1,j(!0),e.next=5,S()(n);case 5:r=e.sent,j(!1),e.next=15;break;case 9:throw e.prev=9,e.t0=e.catch(1),console.error("An error occurred in fetchStoresByGeo:",e.t0),I(!0),j(!1),Error("Failed");case 15:return e.abrupt("return",r.data.stores);case 16:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(a,t){return e.apply(this,arguments)}}();(function(){var a=Object(O.a)(y.a.mark((function a(){var t;return y.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return v(),console.log("Fetching store data..."),a.prev=2,a.next=5,e(u,5e3);case 5:t=a.sent,console.log("New store data fetched"),console.log(t),v(),Q(t),a.next=15;break;case 12:a.prev=12,a.t0=a.catch(2),console.error("Failed to fetch data");case 15:case"end":return a.stop()}}),a,null,[[2,12]])})));return function(){return a.apply(this,arguments)}})()()}),[u,Q]),Object(n.useEffect)((function(){l&&(l.setCenter(u),l.setZoom(14))}),[l,u]),Object(n.useEffect)((function(){l&&p(l,o)}),[o,l,p]),Object(n.useCallback)((function(){var e=(new Date).getDay();return 0===e||6===e?a("maskBuyAlertWeekend"):a("maskBuyAlertWeekday",{dayOfWeek:a("dayOfWeek.".concat(T[e].weekday)),digits:T[e].availableDigits.join(", ")})}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement("main",null,r.a.createElement(C.a,{id:"mainContainer"},r.a.createElement(x.a,null,r.a.createElement(M.a,{sm:12},P&&r.a.createElement(F.a,{variant:"warning",onClose:function(){return G(!1)},dismissible:!0},r.a.createElement(i.a,{icon:s.b})," ",a("notice.publicMaskShutdown")))),r.a.createElement(x.a,null,r.a.createElement(M.a,{md:6},r.a.createElement(R,null),r.a.createElement(N.a,{variant:"outline-primary",className:"mt-1 mb-1",block:!0,onClick:function(){var e=l.getCenter();d({lat:e.y,lng:e.x})}},r.a.createElement(i.a,{icon:s.c})," ",a("refreshMapStores"))),r.a.createElement(M.a,{md:6},L&&r.a.createElement(F.a,{variant:"danger",className:"mt-1"},r.a.createElement(i.a,{icon:s.b})," ",a("error.failedToLoadData")),r.a.createElement("div",{className:"border p-1 mb-1 d-flex flex-row justify-content-between"},r.a.createElement("div",{class:"form-check"},r.a.createElement("input",{type:"checkbox",disabled:!0,class:"form-check-input",id:"showPlentyStores",name:"plenty",defaultChecked:V.plenty,value:V.plenty,onChange:U}),r.a.createElement("label",{class:"form-check-label",htmlFor:"showPlentyStores"},r.a.createElement(X,{remainingStockStr:"plenty"})," ","100\uac1c +")),r.a.createElement("div",{class:"form-check"},r.a.createElement("input",{type:"checkbox",disabled:!0,class:"form-check-input",id:"showSomeStores",name:"some",defaultChecked:V.some,value:V.some,onChange:U}),r.a.createElement("label",{class:"form-check-label",for:"showSomeStores"},r.a.createElement(X,{remainingStockStr:"some"})," ","30-100")),r.a.createElement("div",{class:"form-check"},r.a.createElement("input",{type:"checkbox",disabled:!0,class:"form-check-input",id:"showFewStores",name:"few",defaultChecked:V.few,value:V.few,onChange:U}),r.a.createElement("label",{class:"form-check-label",for:"showFewStores"},r.a.createElement(X,{remainingStockStr:"few"})," ","2-30")),r.a.createElement("div",{class:"form-check"},r.a.createElement("input",{type:"checkbox",disabled:!0,class:"form-check-input",id:"showEmptyStores",name:"empty",defaultChecked:V.empty,value:V.empty,onChange:U}),r.a.createElement("label",{class:"form-check-label",for:"showEmptyStores"},r.a.createElement(X,{remainingStockStr:"empty"})," ","0\uac1c"))),w?r.a.createElement(A.a,{animation:"border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")):o&&o.length?r.a.createElement(r.a.Fragment,null,r.a.createElement($,{style:{overflow:"auto",maxHeight:"100px"}})):r.a.createElement(F.a,{variant:"danger"},"\uc8fc\ubcc0\uc5d0 \ub9c8\uc2a4\ud06c \ud310\ub9e4\ucc98\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \uc9c0\ub3c4\ub97c \uc774\ub3d9\ud55c \ud6c4 \uc9c0\ub3c4 \uc544\ub798\uc758 \uc7ac\uac80\uc0c9 \ubc84\ud2bc\uc744 \uc774\uc6a9\ud574 \uc8fc\uc138\uc694."))))))},Q=t(139);var U=function(){var e=g().centerCoord,a=Object(b.b)().t,t=Object(n.useState)(!0),c=Object(h.a)(t,2),l=c[0],o=c[1],s=function(){return o(!1)};return r.a.createElement(r.a.Fragment,null,e?r.a.createElement(K,null):r.a.createElement(B,null),r.a.createElement(Q.a,{show:l,onHide:s},r.a.createElement(Q.a.Header,{closeButton:!0},r.a.createElement(Q.a.Title,null,a("serviceShutdown"))),r.a.createElement(Q.a.Body,null,r.a.createElement("p",null,a("notice.publicMaskShutdown"))),r.a.createElement(Q.a.Footer,null,r.a.createElement(N.a,{variant:"secondary",href:"https://livecorona.co.kr"},a("covid19Dashboard")),r.a.createElement(N.a,{variant:"primary",onClick:s},a("close")))))};var Y=function(){return r.a.createElement(n.Suspense,{fallback:r.a.createElement("div",null)},r.a.createElement(E,null,r.a.createElement("header",{className:"App-header"},r.a.createElement(v,null)),r.a.createElement(U,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ee=t(62),ae=t(88),te=t(89);ee.a.use(te.a).use(ae.a).use(b.a).init({fallbackLng:"ko",debug:!1,interpolation:{escapeValue:!1}});ee.a;l.a.render(r.a.createElement(Y,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},60:function(e){e.exports=JSON.parse('[{"weekday":"sun","availableDigits":[0,1,2,3,4,5,6,7,8,9]},{"weekday":"mon","availableDigits":[1,6]},{"weekday":"tue","availableDigits":[2,7]},{"weekday":"wed","availableDigits":[3,8]},{"weekday":"thurs","availableDigits":[4,9]},{"weekday":"fri","availableDigits":[5,0]},{"weekday":"sat","availableDigits":[0,1,2,3,4,5,6,7,8,9]}]')},76:function(e,a,t){e.exports=t.p+"static/media/MaskMapLogo.b988c109.svg"},84:function(e,a,t){e.exports=t.p+"static/media/MaskMapIntro.146663f2.svg"},91:function(e,a,t){e.exports=t(131)}},[[91,1,2]]]);
//# sourceMappingURL=main.580ed8b0.chunk.js.map